"""
This script takes an existing 8x16 character set hex file and inserts the VT52 line drawing characters at the proper locations.

The character set hex file is assumed to contain 256 characters, with each character represented as 16 bytes (one byte per row).
"""
import os

# VT52 line drawing characters
vt52_characters = {
    0x18: "upper_left",
    0x19: "horizontal",
    0x1A: "upper_right", 
    0x1B: "vertical_right_tee",
    0x1C: "crossing",
    0x1D: "vertical_left_tee",
    0x1E: "lower_left",
    0x1F: "horizontal_bottom_tee"
}

# Character set hex file
character_set_file = "rtl/mem/character_set.hex"

"""
VT52 Line Drawing Character Bitmaps
Each character is represented as an 8x16 bitmap, with the top 2 and bottom 4 rows being blank (0x00).
The bitmap data is provided as a sequence of hex bytes.
"""

# Upper left corner (0x18)
upper_left = [
    0x00, 0x00, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
]

# Horizontal line (0x19)
horizontal = [ 
    0x00, 0x00, 0x00, 0x00, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
]

# Upper right corner (0x1A)
upper_right = [
    0x00, 0x00, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
]

# Vertical line with right tee (0x1B) 
vertical_right_tee = [
    0x00, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
]

# Crossing lines (0x1C)
crossing = [
    0x00, 0x18, 0x00, 0x7E, 0x18, 0x18, 0x7E, 0x00, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
]

# Vertical line with left tee (0x1D)
vertical_left_tee = [
    0x00, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
]

# Lower left corner (0x1E)
lower_left = [
    0x00, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
]

# Horizontal line with bottom tee (0x1F)
horizontal_bottom_tee = [
    0x00, 0x00, 0x00, 0x00, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x18, 0x00, 0x00, 0x00, 0x00, 0x00
]

def insert_vt52_characters(character_set_file):
    with open(character_set_file, "r") as file:
        character_data = file.readlines()

    for vt52_char, bitmap in vt52_characters.items():
        start = vt52_char * 16
        bitmap_lines = [f"{byte:02X}" for byte in globals()[bitmap]]
        character_data[start:start+16] = [line + "\n" for line in bitmap_lines]

    with open(character_set_file, "w") as file:
        file.writelines(character_data)

    print(f"VT52 line drawing characters added to {character_set_file}")

# Get the current working directory
current_dir = os.getcwd()
print(f"Current working directory: {current_dir}")

# Example usage
insert_vt52_characters(character_set_file)